<!DOCTYPE html>
<html>
<head>
    <title>Tab-Konfiguration</title>
    <meta charset="utf-8" />
    <script src="https://statics.teams.cdn.office.net/sdk/v1.12.0/js/MicrosoftTeams.min.js"></script>
</head>
<body>
    <h2>AI Tab einrichten</h2>
    <input id="titleInput" type="text" placeholder="Tab-Name, z.B. Projekt Manager" />
    <button id="saveBtn">Speichern aktivieren</button>

    <script>
        let tabName = "";

        microsoftTeams.app.initialize().then(() => {
            // Initial: Speichern deaktiviert
            microsoftTeams.pages.config.setValidityState(true);

            // Eingabe aktiviert Teams-Speichern
            document.getElementById("titleInput").addEventListener("input", function(e) {
                tabName = e.target.value;
                microsoftTeams.pages.config.setValidityState(tabName.trim().length > 0);
            });

            // Debug-Button
            document.getElementById("saveBtn").onclick = function () {
                alert("Im Teams-Konfigurations-Dialog speichern Sie über den Teams-Button rechts unten!");
            };

            // Teams-Konfigurationslogik für den SPEICHERN-Button
            microsoftTeams.pages.config.registerOnSaveHandler(function (saveEvent) {
                microsoftTeams.pages.config.setConfig({
                    entityId: tabName || "MeinTab",
                    contentUrl: "https://delightful-mushroom-05e70a703.1.azurestaticapps.net?name=" + encodeURIComponent(tabName),
                    websiteUrl: "https://delightful-mushroom-05e70a703.1.azurestaticapps.net/",
                    suggestedDisplayName: tabName || "Project Manager"
                });
                saveEvent.notifySuccess();
            });
        });
    </script>
</body>
</html>
